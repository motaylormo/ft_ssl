# PBKDF: turning the password into a key and IV
To start out, you need a password (string) and a salt (64 bits). If you are given a salt value by the user, use that. If not, generate a random one.

* **password:** `"towel"`
* **salt:** `4242424242424242`

Concatenate password and salt together:
* **hex:** `74 6f 77 65 6c 42 42 42 42 42 42 42 42`
* **ascii:** `"towelBBBBBBBB"`

MD5 hash that:
```
MD5 ("towelBBBBBBBB") = daf91e7c5a178dfe90650f38c6e46f2b
```

Split that in half. The left half becomes the key, the right half becomes the IV:
* **key:** `daf91e7c5a178dfe`
* **IV:** `90650f38c6e46f2b`

# Key Schedule: turing 1 key into 16 subkeys
We start with our 64-bit key:
* **hex:** `daf91e7c5a178dfe`
* **binary:** `1101101011111001000111100111110001011010000101111000110111111110`

Run that through permuted choice 1, turing the key from 64-bits to 56-bits:
* **hex:** `0c39b8abb5ecdff`
* **binary:** `11000011100110111000101010111011010111101100110111111111`

Split that into 2 halves of 28-bits:
* **left:** `c39b8ab` (`1100001110011011100010101011`)
* **right:** `b5ecdff` (`1011010111101100110111111111`)

Now the 16 rounds. Within each round,
1. the halves' bits are each rotated left by the number specified in the rotation table
2. concatenated together again (56-bits)
3. run through permuted choice 2 (56-bits to 48-bits)

| Round | Left | Right | Catted | PC-2 |
| ----: | ---- | ----- | ------ | ---- |
| 0 | `11000011100110111000101010111`<br>(`18737157`) | `10110101111011001101111111111`<br>(`16bd9bff`) | `00000000000000000000000001110110101111011001101111111111`<br>(`087371576bd9bff`) | `000000000000000011111100111111111111110101001100`<br>(`b9c2fcfffd4c`)
| 1 | `110000111001101110001010101111`<br>(`30e6e2af`) | `101101011110110011011111111110`<br>(`2d7b37fe`) | `00000000000000000000000011111101011110110011011111111110`<br>(`00e6e2afd7b37fe`) | `000000000000000010011010010111111001111011101111`<br>(`a5fc9a5f9eef`)
| 2 | `11000011100110111000101010111100`<br>(`c39b8abc`) | `10110101111011001101111111111011`<br>(`b5ecdffb`) | `00000000000000000000000011000101111011001101111111111011`<br>(`039b8abc5ecdffb`) | `000000000000000011000010110111101111110111111001`<br>(`762fc2defdf9`)
| 3 | `1110011011100010101011110000`<br>(`e6e2af0`) | `11010111101100110111111111101101`<br>(`d7b37fed`) | `00000000000000000000000000000111101100110111111111101101`<br>(`0e6e2af07b37fed`) | `000000000000000000010001001010111111111101111101`<br>(`7afc112bff7d`)
| 4 | `111001101110001010101111000011`<br>(`39b8abc3`) | `1011110110011011111111110110101`<br>(`5ecdffb5`) | `00000000000000000000000000111110110011011111111110110101`<br>(`09b8abc3ecdffb5`) | `000000000000000001011110111110111111110110110010`<br>(`4da55efbfdb2`)
| 5 | `11100110111000101010111100001110`<br>(`e6e2af0e`) | `1111011001101111111111011010111`<br>(`7b37fed7`) | `00000000000000000000000011101011001101111111111011010111`<br>(`06e2af0eb37fed7`) | `000000000000000010011111111011010100111100111111`<br>(`66c49fed4f3f`)
| 6 | `10011011100010101011110000111001`<br>(`9b8abc39`) | `11101100110111111111101101011110`<br>(`ecdffb5e`) | `00000000000000000000000010011100110111111111101101011110`<br>(`0b8abc39cdffb5e`) | `000000000000000000100010110111110111101011011110`<br>(`7f8922df7ade`)
| 7 | `1101110001010101111000011100110`<br>(`6e2af0e6`) | `10110011011111111110110101111011`<br>(`b37fed7b`) | `00000000000000000000000001100011011111111110110101111011`<br>(`0e2af0e637fed7b`) | `000000000000000010111011111101011101001111111101`<br>(`aaa8bbf5d3fd`)
| 8 | `11011100010101011110000111001101`<br>(`dc55e1cd`) | `1100110111111111101101011110110`<br>(`66ffdaf6`) | `00000000000000000000000011010110111111111101101011110110`<br>(`0c55e1cd6ffdaf6`) | `000000000000000011000111111111111110111010011100`<br>(`89f2c7ffee9c`)
| 9 | `1110001010101111000011100110111`<br>(`71578737`) | `10011011111111110110101111011001`<br>(`9bff6bd9`) | `00000000000000000000000001111011111111110110101111011001`<br>(`01578737bff6bd9`) | `000000000000000011001110011110010111011111011111`<br>(`315fce7977df`)
| 10 | `11000101010111100001110011011100`<br>(`c55e1cdc`) | `1101111111111011010111101100110`<br>(`6ffdaf66`) | `00000000000000000000000011001111111111011010111101100110`<br>(`055e1cdcffdaf66`) | `000000000000000011100001101111111111000010101111`<br>(`7071e1bff0af`)
| 11 | `10101011110000111001101110001`<br>(`15787371`) | `10111111111101101011110110011011`<br>(`bff6bd9b`) | `00000000000000000000000000011111111101101011110110011011`<br>(`05787371ff6bd9b`) | `000000000000000001110101111001100111111111100111`<br>(`91cd75e67fe7`)
| 12 | `1010101111000011100110111000101`<br>(`55e1cdc5`) | `11111111110110101111011001101111`<br>(`ffdaf66f`) | `00000000000000000000000001011111110110101111011001101111`<br>(`05e1cdc5fdaf66f`) | `000000000000000010010111101111101010101111111111`<br>(`c56397beabff`)
| 13 | `1010111100001110011011100010101`<br>(`57873715`) | `11111111011010111101100110111111`<br>(`ff6bd9bf`) | `00000000000000000000000001011111011010111101100110111111`<br>(`07873715f6bd9bf`) | `000000000000000010100101111101111101111111010011`<br>(`3797a5f7dfd3`)
| 14 | `1011110000111001101110001010101`<br>(`5e1cdc55`) | `11111101101011110110011011111111`<br>(`fdaf66ff`) | `00000000000000000000000001011101101011110110011011111111`<br>(`0e1cdc55daf66ff`) | `000000000000000011100011010111111010011101111011`<br>(`db10e35fa77b`)
| 15 | `10111100001110011011100010101011`<br>(`bc39b8ab`) | `11111011010111101100110111111111`<br>(`fb5ecdff`) | `00000000000000000000000010111011010111101100110111111111`<br>(`0c39b8abb5ecdff`) | `000000000000000001111011111101001101011111111111`<br>(`49aa7bf4d7ff`)
